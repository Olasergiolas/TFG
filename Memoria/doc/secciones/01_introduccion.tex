\chapter{Introducción}

\section{Motivación}
En la actualidad, podemos fácilmente apreciar cómo los fabricantes de productos de todo tipo de
ámbitos como pueden ser la medicina, la industria, la seguridad o incluso el hogar, apuestan cada vez 
más por desarrollar nuevas iteraciones de estos productos con funcionalidades comúnmente agrupadas bajo el 
adjetivo de inteligentes o ''smart''. Este nuevo paradigma de dispositivos inteligentes capaces de 
comunicarse entre sí y trabajar de forma coordinada conocido como el ''Internet de las Cosas'' o IoT por 
sus siglas en Inglés ha experimentado un crecimiento descontrolado durante la última década debido 
principalmente a los avances realizados en campos como las telecomunicaciones o el diseño de procesadores y
SoCs con una mayor potencia y menor consumo. Tal es el crecimiento que actualmente se espera que la industria del
IoT pueda alcanzar un valor económico potencial de entre 5.5 y 12.6 miles de millones de dólares para
2030 \cite{McKinsey}.
\bigskip
Dispositivos no tan novedosos como cámaras IP o routers, al igual que otros más 
propios de la última década como asistentes de voz, Smart TVs o wearables son todos ejemplos 
de dispositivos IoT que han conseguido ser una parte esencial de nuestro día a día facilitándonos
multitud de tareas. Aunque no es secreto que este tipo de dispositivos suelen basar su funcionalidad en 
la recopilación y comunicación de información que puede llegar a ser considerada sensible, es una realidad 
que los fabricantes de dichos dispositivos no están realizando una inversión suficiente en su seguridad y 
la de los datos que manejan. Un claro ejemplo de ello es el hecho de que en Europa, casi la mitad 
de dispositivos del fabricante TP-Link utiliza credenciales por defecto \cite{Deepak}, sin forzar al usuario 
a cambiarlas o incluso el gran número de estos que son puestos a la venta a día de hoy utilizando software 
considerablemente desactualizado y vulnerable como pueden ser versiones del kernel de linux publicadas hace cerca de 
diez años y ya consideradas ''End Of Life''. Problemas como los mencionados dan lugar a grandes brechas de
seguridad, que explotadas por un atacante pueden tener consecuencias desastrosas. Ejemplo de ello es 
Mirai\cite{mirai}, un malware que identificaba dispositivos IoT como routers o cámaras IP que usaran credenciales 
por defecto conocidas para infectarlos y crear una botnet que permitiera realizar ataques DDoS a gran escala.\\

Los motivos de esta pasividad por parte de un gran número de fabricantes de dispositivos IoT respecto a la 
seguridad de sus productos son varios. En primer lugar, es necesario tener en cuenta que estamos ante una industria relativamente 
joven, en claro auge y con un gran interés para todo tipo de compañías que quieren introducirse en ella diseñando 
nuevos productos pero con la dificultad de carecer de experiencia previa en el sector. Esta falta de experiencia puede
llevar a tomar decisiones como el realizar lanzamientos apresurados en los que la seguridad del producto no haya 
sido evaluada adecuadamente o el buscar reducir costes obviando aspectos de seguridad que puedan afectar a 
la tríada CIA (Confidentiality, Integrity, Availability) en productos de gamas low-cost donde el margen de beneficio 
es más estrecho. Por último, otro de los principales factores a tener en cuenta es lo sumamente limitado que 
está en la mayoría de ocasiones el IoT respecto a factores como rendimiento, limitado por los bajos consumos 
requeridos, memoria, limitada por costes/tamaño del dispositivo o tiempo, limitado en sistemas de tiempo real. 
Se ha demostrado cómo para un STM32, hacer uso de un algoritmo de cifrado para las comunicaciones puede suponer 
penalizaciones de hasta 111ms\cite{performance} para cifrar y descifrar 1KB de información usando un algoritmo como AES\_CBC.\bigskip

Aplicar técnicas que pudieran ayudar a mejorar la seguridad ''automatizando'' la búsqueda de vulnerabilidades presentes en los componentes software 
de estos dispositivos sería de gran ayuda para facilitar y agilizar el proceso de identificación, análisis y corrección 
de bugs y fallos de seguridad. El fuzzing es una técnica utilizada para encontrar bugs en software mediante la ejecución de 
programas de forma repetida, haciendo uso de datos de entrada generados artificialmente a través de mutaciones aplicadas a otros
inputs. Estos inputs generados suelen distar considerablemente de los inputs para los que el software fue diseñado 
originalmente, por lo que se busca forzar a este a entrar en estados indefinidos potencialmente problemáticos. Aplicar
fuzzing a dispositivos IoT se vuelve especialmente interesante debido a que estos trabajan con grandes cantidades de inputs,
sea información en formato JSON, XML, un mensaje MQTT, se trata de inputs que provienen del exterior a través de la red y que en teoría deberían de ser validados 
de forma exhaustiva para asegurar un correcto funcionamiento incluso si la información recibida no respeta el formato o protocolo 
utilizado. Por ejemplo, aplicando fuzzing sobre un componente del firmware de un dispositivo IoT encargado de parsear información en formato JSON
se podría detectar si este presenta un comportamiento indeterminado en casos concretos como al recibir datos con caracteres especiales, lo cual
podría dar lugar a vulnerabilidades potenciales como denegación de servicio, corrupción de memoria o filtración de información. Respecto a casos reales
de vulnerabilidades críticas encontradas en dispositivos IoT a través de fuzzing podemos destacar entre otros los descubrimientos realizados por la firma 
de ciberseguridad ''Comsecuris'', que gracias a aplicar fuzzing descubrieron una vulnerabilidad en el gestor de red usado en el 
sistema operativo de los vehículos Tesla la cual permitía a un atacante realizar ejecución de código de forma remota y sin autenticar \cite{TeslaMCU}.

Cabe mencionar que emplear fuzzing orientado a IoT también presenta sus propios retos y complicaciones no tan presentes en el fuzzing tradicional. 
Ejemplos de estos retos son el disponer exclusivamente de binarios compilados para otras arquitecturas, la baja velocidad de ejecución al fuzzear o la 
dificultad de aplicar rehosting entre otros y serán discutidos a lo largo del documento.\bigskip

En resumen, el fuzzing es una técnica que ha demostrado excelentes resultados a la hora de identificar bugs 
que hubieran sido difícilmente encontrados a través de otros medios y que, aún presentando retos difíciles de abordar, resulta de especial interés en
el campo del IoT ya que facilitaría la mejora de los estándares de seguridad actuales de la industria. Durante este proyecto trataremos de investigar
e implementar algunos de los distintos enfoques existentes en la actualidad del fuzzing IoT orientado a código y se intentará proponer 
soluciones a los retos planteados anteriormente.

\section{Objetivos}
El objetivo principal de este proyecto, es llevar a cabo una investigación sobre el estado del arte de la aplicación de fuzzing de código en dispositivos IoT
a través de emulación, es decir, ejecutando el código a fuzzear sin requerir el hardware del dispositivo en cuestión.
Además, como objetivos complementarios a cumplir durante la realización de este proyecto se plantea lo siguiente:
\begin{itemize}
    \item Estudiar y poner en práctica los enfoques más punteros y 
    conceptos relacionados al respecto como el reversing de firmware, rehosting, emulación de sistema, binarios y de instrucciones máquina, 
    sanitizadores de memoria, black-box y grey-box fuzzing. Esto se llevará a cabo desarrollando diversas pruebas de concepto que hagan uso
    de estas tecnologías.
    \item Comparar la efectividad a la hora de identificar vulnerabilidades mediante fuzzing de los distintos enfoques que serán objeto de estudio. 
    Se tendrán en cuenta parámetros como diferencias de tiempo hasta alcanzar una misma vulnerabilidad, número de ejecuciones por segundo o estabilidad.
    \item Proporcionar un entorno de trabajo a modo de contenedor Docker que contenga todas las herramientas necesarias para llevar a cabo tareas de 
    fuzzing y emulación de dispositivos IoT (fuzzing de arquitectura cruzada). Esto no solo facilitará la reproducibilidad de las pruebas de 
    concepto desarrolladas sino que también puede ser de utilidad para todo aquel dispuesto a iniciarse en este campo. Además, se hará uso de 
    integración continua para automatizar el compilado y publicación de la imagen en DockerHub.
\end{itemize}

Con la realización de este proyecto también se plantean una serie de objetivos más personales como son el 


- Ampliar mis conocimientos para poder colaborar con la búsqueda de vulnerabilidades en estos dispositivos
- Aportar a la comunidad de software libre
- Colaborar con la investigación en ciberseguridad para ayudar a encontrar vulnerabilidades
 

\section{Estructura}
